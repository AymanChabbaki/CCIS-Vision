# Entity-Relationship Diagram - CCIS-Vision Database

## Overview Diagram (Simplified)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CCIS-Vision Database Structure                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     USERS        â”‚         â”‚   DEPARTMENTS    â”‚         â”‚    LOCATIONS     â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ â—† id (UUID)      â”‚â”€â”€â”€â”€â”    â”‚ â—† id             â”‚    â”Œâ”€â”€â”€â”‚ â—† id             â”‚
â”‚   username       â”‚    â”‚    â”‚   name           â”‚    â”‚   â”‚   name           â”‚
â”‚   email          â”‚    â”‚    â”‚   code           â”‚    â”‚   â”‚   type           â”‚
â”‚   password_hash  â”‚    â”‚    â”‚   location_id    â”‚â”€â”€â”€â”€â”˜   â”‚   city           â”‚
â”‚ â—‹ role_id        â”‚    â”‚    â”‚   description    â”‚        â”‚   latitude       â”‚
â”‚ â—‹ department_id  â”‚â”€â”€â”€â”€â”¼â”€â”€â”€â–¶â”‚   head_name      â”‚        â”‚   longitude      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚    â”‚    COMPANIES     â”‚         â”‚ COMPANY_SECTORS  â”‚
                        â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                        â”‚    â”‚ â—† id (UUID)      â”‚    â”Œâ”€â”€â”€â”‚ â—† id             â”‚
                        â”‚    â”‚   name           â”‚    â”‚   â”‚   name           â”‚
                        â”‚    â”‚   legal_name     â”‚    â”‚   â”‚   code           â”‚
                        â”‚    â”‚   ice            â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚    â”‚   email          â”‚    â”‚
                        â”‚    â”‚   phone          â”‚    â”‚
                        â”‚    â”‚   address        â”‚    â”‚
                        â”‚    â”‚   city           â”‚    â”‚
                        â”‚    â”‚   latitude       â”‚    â”‚
                        â”‚    â”‚   longitude      â”‚    â”‚
                        â”‚    â”‚ â—‹ sector_id      â”‚â”€â”€â”€â”€â”˜
                        â”‚    â”‚   data_quality_score    
                        â”‚    â”‚   needs_verification    
                        â”‚    â”‚ â—‹ duplicate_of   â”‚â”€â”€â” (self-reference)
                        â””â”€â”€â”€â–¶â”‚ â—‹ created_by     â”‚  â”‚
                             â”‚ â—‹ updated_by     â”‚  â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â—€â”€â”˜
                                      â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                     â”‚                     â”‚
                â–¼                     â–¼                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  PARTICIPANTS    â”‚  â”‚ SERVICES_PROVIDEDâ”‚  â”‚  ACTIVITY_PART.  â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ â—† id (UUID)      â”‚  â”‚ â—† id (UUID)      â”‚  â”‚ â—† activity_id    â”‚
    â”‚   first_name     â”‚  â”‚ â—‹ service_type_idâ”‚  â”‚ â—† partner_id     â”‚
    â”‚   last_name      â”‚  â”‚ â—‹ company_id     â”‚  â”‚   contribution   â”‚
    â”‚   email          â”‚  â”‚ â—‹ department_id  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚   phone          â”‚  â”‚   request_date   â”‚           â”‚
    â”‚ â—‹ company_id     â”‚  â”‚   status         â”‚           â”‚
    â”‚ â—‹ activity_id    â”‚  â”‚   cost           â”‚           â”‚
    â”‚   registration_  â”‚  â”‚   outcome        â”‚           â”‚
    â”‚   attendance_    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚   satisfaction   â”‚                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
            â”‚                                            â”‚
            â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   ACTIVITIES     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                       â”‚ â—† id (UUID)      â”‚
                       â”‚   title          â”‚
                       â”‚   description    â”‚
                       â”‚ â—‹ activity_type_id
                       â”‚ â—‹ department_id  â”‚
                       â”‚ â—‹ location_id    â”‚
                       â”‚   start_date     â”‚
                       â”‚   end_date       â”‚
                       â”‚   budget_allocated
                       â”‚   budget_spent   â”‚
                       â”‚   status         â”‚
                       â”‚   version        â”‚â”€â”€â” (historization)
                       â”‚ â—‹ previous_versionâ”‚â—€â”€â”˜
                       â”‚ â—‹ created_by     â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â–¼                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   FORMATIONS     â”‚  â”‚ ACTIVITY_TYPES   â”‚
            â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
            â”‚ â—† id (UUID)      â”‚  â”‚ â—† id             â”‚
            â”‚ â—‹ activity_id    â”‚  â”‚   name           â”‚
            â”‚ â—‹ category_id    â”‚  â”‚   code           â”‚
            â”‚   level          â”‚  â”‚   description    â”‚
            â”‚   duration_hours â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚   trainer_name   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     BUDGETS      â”‚         â”‚    EXPENSES      â”‚         â”‚  BUDGET_CATEG.   â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ â—† id (UUID)      â”‚    â”Œâ”€â”€â”€â”‚ â—† id (UUID)      â”‚         â”‚ â—† id             â”‚
â”‚   fiscal_year    â”‚    â”‚   â”‚ â—‹ budget_id      â”‚â”€â”€â”€â”€â”    â”‚   name           â”‚
â”‚ â—‹ department_id  â”‚    â”‚   â”‚ â—‹ activity_id    â”‚    â”‚    â”‚   code           â”‚
â”‚ â—‹ category_id    â”‚â”€â”€â”€â”€â”˜   â”‚   expense_date   â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   allocated_amt  â”‚        â”‚   description    â”‚    â”‚
â”‚   spent_amount   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”‚   amount         â”‚    â”‚
â”‚   committed_amt  â”‚        â”‚   supplier       â”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   payment_status â”‚    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                                                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”‚  EXCEL IMPORT & DATA QUALITY TRACKING
â”‚
â”œâ”€â”€â–¶â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â”‚  IMPORT_LOGS     â”‚         â”‚ RAW_EXCEL_DATA   â”‚
â”‚   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚   â”‚ â—† id (UUID)      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â—† id (UUID)      â”‚
â”‚   â”‚   filename       â”‚         â”‚ â—‹ import_log_id  â”‚
â”‚   â”‚   file_hash      â”‚         â”‚   row_number     â”‚
â”‚   â”‚   data_type      â”‚         â”‚   raw_data (JSON)â”‚
â”‚   â”‚ â—‹ uploaded_by    â”‚         â”‚   status         â”‚
â”‚   â”‚   status         â”‚         â”‚   error_message  â”‚
â”‚   â”‚   total_rows     â”‚         â”‚   mapped_entity_type
â”‚   â”‚   rows_imported  â”‚         â”‚   mapped_entity_id
â”‚   â”‚   rows_with_errors        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â–¶â”‚ DATA_QUAL_ISSUES â”‚         â”‚ DATA_QUAL_RULES  â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ â—† id (UUID)      â”‚    â”Œâ”€â”€â”€â”‚ â—† id             â”‚
    â”‚   entity_type    â”‚    â”‚   â”‚   entity_type    â”‚
    â”‚   entity_id      â”‚    â”‚   â”‚   field_name     â”‚
    â”‚   field_name     â”‚    â”‚   â”‚   rule_type      â”‚
    â”‚ â—‹ rule_id        â”‚â”€â”€â”€â”€â”˜   â”‚   validation_pat.â”‚
    â”‚   issue_descrip. â”‚        â”‚   error_message  â”‚
    â”‚   severity       â”‚        â”‚   is_active      â”‚
    â”‚   status         â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚   detected_date  â”‚
    â”‚ â—‹ resolved_by    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AUDIT_LOG      â”‚         â”‚     ALERTS       â”‚         â”‚   ALERT_TYPES    â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ â—† id (UUID)      â”‚         â”‚ â—† id (UUID)      â”‚    â”Œâ”€â”€â”€â”‚ â—† id             â”‚
â”‚   table_name     â”‚         â”‚ â—‹ alert_type_id  â”‚â”€â”€â”€â”€â”˜   â”‚   name           â”‚
â”‚   record_id      â”‚         â”‚   entity_type    â”‚        â”‚   description    â”‚
â”‚   action         â”‚         â”‚   entity_id      â”‚        â”‚   default_thresh.â”‚
â”‚   old_values (JSON)        â”‚   title          â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   new_values (JSON)        â”‚   message        â”‚
â”‚   changed_fields â”‚         â”‚   severity       â”‚
â”‚ â—‹ changed_by     â”‚         â”‚   is_active      â”‚
â”‚   changed_at     â”‚         â”‚   is_read        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Detailed Relationships

### 1. User Management
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ROLES   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚    USERS     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  1    *  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ 1
                              â”‚
                              â”‚ *
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ DEPARTMENTS  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Company Relationships
```
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”Œâ”€â”€â”€â”€â”€â–¶â”‚ PARTICIPANTS   â”‚
               â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚COMPANIES â”‚â”€â”€â”¼â”€â”€â”€â”€â”€â–¶â”‚ SERVICES_PROV. â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     1        â”‚
     â”‚        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚        â””â”€â”€â”€â”€â”€â–¶â”‚ ACTIVITY_PART. â”‚
     â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     *
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚COMPANY_SECTORSâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Activity Module
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  1   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  *   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ACTIVITY_TYPESâ”‚â—€â”€â”€â”€â”€â–¶â”‚ ACTIVITIES â”‚â—€â”€â”€â”€â”€â–¶â”‚ PARTICIPANTS â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ 1
                            â”‚
                            â”‚ 1
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚FORMATIONSâ”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ *
                            â”‚
                            â”‚ 1
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚TRAINING_CATEGOR. â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Financial Tracking
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  *   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  1   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚DEPARTMENTSâ”‚â—€â”€â”€â”€â”€â–¶â”‚BUDGETS â”‚â—€â”€â”€â”€â”€â–¶â”‚BUDGET_CATEGOR. â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ 1
                        â”‚
                        â”‚ *
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ EXPENSES â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ *
                        â”‚
                        â”‚ 1
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ACTIVITIESâ”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. Data Import & Quality
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  1   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USERS   â”‚â—€â”€â”€â”€â”€â–¶â”‚ IMPORT_LOGS    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ 1
                         â”‚
                         â”‚ *
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚RAW_EXCEL_DATA   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ maps to
                         â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ COMPANIES       â”‚
                  â”‚ or ACTIVITIES   â”‚
                  â”‚ or PARTICIPANTS â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  1   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚DATA_QUAL_RULES  â”‚â—€â”€â”€â”€â”€â–¶â”‚DATA_QUAL_ISSUES   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ references
                                  â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ Any Entity   â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Tables by Function

### ğŸ” Authentication & Authorization
- `users` - User accounts
- `roles` - Role definitions

### ğŸ¢ Organization
- `locations` - Offices (Siege, Annexes)
- `departments` - Organizational units

### ğŸ­ Core Entities
- `companies` - Member companies (CENTRAL TABLE)
- `company_sectors` - Industry classification
- `partners` - External partners

### ğŸ“Š Activity Management
- `activities` - All types of activities
- `activity_types` - Formation, Event, Project, Service
- `formations` - Training details
- `participants` - Beneficiaries
- `services_provided` - Services to companies

### ğŸ’° Financial
- `budgets` - Budget allocations
- `expenses` - Expense tracking
- `budget_categories` - Budget classification

### ğŸ“¥ Data Import (Excel Migration)
- `import_logs` - Track imports
- `raw_excel_data` - Store raw data
- `data_quality_rules` - Validation rules
- `data_quality_issues` - Track problems

### ğŸ“œ Audit & History
- `audit_log` - Change tracking
- `alerts` - System alerts
- `alert_types` - Alert definitions

## Indexes & Performance

### Primary Indexes (Automatic)
- All `id` fields are PRIMARY KEY
- UUID types for distributed system compatibility
- SERIAL types for simple lookup tables

### Search Indexes
```sql
-- Companies
idx_companies_name (GIN trigram)
idx_companies_ice (B-tree)
idx_companies_city (B-tree)
idx_companies_sector (B-tree)

-- Activities
idx_activities_type (B-tree)
idx_activities_department (B-tree)
idx_activities_dates (B-tree composite)
idx_activities_status (B-tree)

-- Participants
idx_participants_activity (B-tree)
idx_participants_company (B-tree)
idx_participants_email (B-tree)
```

### Foreign Key Indexes (Automatic)
All foreign key relationships automatically create indexes

## Data Flow: Excel Import Example

```
1. User uploads Excel file
   â†“
2. Create IMPORT_LOGS entry
   â†“
3. Parse Excel rows â†’ RAW_EXCEL_DATA (JSONB)
   â†“
4. Run validation (DATA_QUALITY_RULES)
   â†“
5. Detect issues â†’ DATA_QUALITY_ISSUES
   â†“
6. Clean data (normalize_company_name, clean_ice_number, etc.)
   â†“
7. Check for duplicates (find_duplicate_companies)
   â†“
8. Insert into COMPANIES (or other target table)
   â†“
9. Link RAW_EXCEL_DATA.mapped_entity_id â†’ COMPANIES.id
   â†“
10. Calculate quality score
   â†“
11. Create ALERTS if needed
   â†“
12. Update IMPORT_LOGS with results
   â†“
13. Log to AUDIT_LOG
```

## Cardinality Notes

- One company can have many participants (1:*)
- One activity can have many participants (1:*)
- One activity can have many partners (M:N via activity_partners)
- One department can have many budgets (1:*)
- One budget can have many expenses (1:*)
- One import log can have many raw data rows (1:*)
- One company can be flagged as duplicate of another (1:1 self-reference)
- Activities support versioning (1:1 self-reference via previous_version_id)

## Legend
```
â—† = Primary Key
â—‹ = Foreign Key
â”€â”€â–¶ = One-to-Many
â—€â”€â”€â–¶ = Many-to-Many
â”€â”€â”€â”€â” = Self-reference
    â””â”€â”€â–¶
```
